# amoCRM Fields Mapping

## Кастомные поля в amoCRM

### Контакты (Contacts)

| Поле | ID | Тип | Описание |
|------|----|-----|----------|
| Телефон | 123456 | Телефон | Основной номер телефона |
| Email | 123457 | Email | Email адрес |
| UTM Source | 123458 | Текст | Источник трафика |
| UTM Medium | 123459 | Текст | Канал трафика |
| UTM Campaign | 123460 | Текст | Название кампании |
| UTM Content | 123461 | Текст | Контент объявления |
| UTM Term | 123462 | Текст | Ключевые слова |
| Менеджер | 123465 | Пользователь | Ответственный менеджер |

### Сделки (Leads)

| Поле | ID | Тип | Описание |
|------|----|-----|----------|
| UTM Source | 123458 | Текст | Источник трафика |
| UTM Medium | 123459 | Текст | Канал трафика |
| UTM Campaign | 123460 | Текст | Название кампании |
| UTM Content | 123461 | Текст | Контент объявления |
| UTM Term | 123462 | Текст | Ключевые слова |
| Стоимость объекта | 123463 | Число | Стоимость недвижимости |
| Комиссия | 123464 | Число | Размер комиссии |
| Менеджер | 123465 | Пользователь | Ответственный менеджер |
| Объект | 123466 | Список | Выбранный объект недвижимости |
| Статус оплаты | 123467 | Список | Статус оплаты депозита |

## Статусы воронки

### Asia Deals Pipeline

| Статус | ID | Название | Описание |
|--------|----|----------|----------|
| 1 | 1 | Новый лид | Первичный контакт |
| 2 | 2 | Первичный контакт | Звонок менеджера |
| 3 | 3 | Презентация | Показ объектов |
| 4 | 4 | Выбор объекта | Клиент выбрал недвижимость |
| 5 | 5 | Резервирование | Внесение депозита |
| 6 | 6 | Сделка | Закрытие сделки |
| 7 | 7 | Завершено | Успешная сделка |

## Теги

### Системные теги
- `asia_deals` - основной тег проекта
- `new_lead` - новый лид
- `hot_lead` - горячий лид
- `vip_client` - VIP клиент
- `completed_deal` - завершенная сделка

### UTM теги
- `utm_google` - трафик из Google
- `utm_facebook` - трафик из Facebook
- `utm_instagram` - трафик из Instagram
- `utm_yandex` - трафик из Yandex

## Настройка в amoCRM

### 1. Создание кастомных полей

#### Для контактов:
1. Перейти в Настройки → Поля и воронки
2. Выбрать "Контакты"
3. Создать новые поля с указанными ID

#### Для сделок:
1. Перейти в Настройки → Поля и воронки
2. Выбрать "Сделки"
3. Создать новые поля с указанными ID

### 2. Настройка воронки

1. Создать новую воронку "Asia Deals"
2. Добавить статусы согласно таблице
3. Настроить права доступа

### 3. Настройка webhooks

1. Перейти в Настройки → Интеграции → Webhooks
2. Добавить webhook для:
   - Создание лидов
   - Изменение лидов
   - Создание контактов
   - Изменение контактов

### 4. Настройка прав доступа

1. Создать роль "Asia Deals Manager"
2. Назначить права на:
   - Просмотр контактов
   - Редактирование контактов
   - Создание сделок
   - Изменение сделок

## API интеграция

### Создание контакта
```python
contact_data = {
    "name": "Иван Иванов",
    "custom_fields_values": [
        {
            "field_id": 123456,  # Телефон
            "values": [{"value": "+79001234567", "enum_code": "WORK"}]
        },
        {
            "field_id": 123457,  # Email
            "values": [{"value": "ivan@example.com", "enum_code": "WORK"}]
        },
        {
            "field_id": 123458,  # UTM Source
            "values": [{"value": "google"}]
        }
    ]
}
```

### Создание сделки
```python
lead_data = {
    "name": "Лид: Иван Иванов",
    "_embedded": {
        "contacts": [{"id": contact_id}]
    },
    "custom_fields_values": [
        {
            "field_id": 123463,  # Стоимость объекта
            "values": [{"value": 50000}]
        },
        {
            "field_id": 123464,  # Комиссия
            "values": [{"value": 5000}]
        }
    ]
}
```

## Валидация данных

### Обязательные поля
- Имя контакта
- Телефон
- UTM Source

### Опциональные поля
- Email
- UTM Medium
- UTM Campaign
- UTM Content
- UTM Term

### Форматы данных
- Телефон: +7XXXXXXXXXX
- Email: валидный email формат
- Стоимость: положительное число
- Комиссия: положительное число
