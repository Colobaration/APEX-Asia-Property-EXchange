# üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ APEX

## üéØ –û–±–∑–æ—Ä

–≠—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã APEX Asia Property Exchange.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
docs/setup/
‚îú‚îÄ‚îÄ README.md                    # –≠—Ç–æ—Ç —Ñ–∞–π–ª - –æ–±–∑–æ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ MIGRATION_SYSTEM_SUMMARY.md  # –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π
‚îú‚îÄ‚îÄ API_SERVER_README.md         # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API —Å–µ—Ä–≤–µ—Ä–∞
‚îî‚îÄ‚îÄ WEBHOOK_SETUP.md             # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook'–æ–≤
```

## üìã –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

### **MIGRATION_SYSTEM_SUMMARY.md** - –°–∏—Å—Ç–µ–º–∞ –º–∏–≥—Ä–∞—Ü–∏–π
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å–∏—Å—Ç–µ–º–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–°–æ–¥–µ—Ä–∂–∏—Ç:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- ‚úÖ Entrypoint —Å–∫—Ä–∏–ø—Ç –¥–ª—è Docker
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ —á–µ—Ä–µ–∑ Makefile
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –º–∏–≥—Ä–∞—Ü–∏–π
- ‚úÖ Best practices –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**–î–ª—è –∫–æ–≥–æ:** DevOps –∏–Ω–∂–µ–Ω–µ—Ä—ã, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ backend

### **API_SERVER_README.md** - API —Å–µ—Ä–≤–µ—Ä
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ –∑–∞–ø—É—Å–∫—É API —Å–µ—Ä–≤–µ—Ä–∞

**–°–æ–¥–µ—Ä–∂–∏—Ç:**
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ API endpoints –∏ –∏—Ö –æ–ø–∏—Å–∞–Ω–∏–µ
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ backend
- ‚úÖ –û—Ç–ª–∞–¥–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–î–ª—è –∫–æ–≥–æ:** –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏, DevOps –∏–Ω–∂–µ–Ω–µ—Ä—ã

### **WEBHOOK_SETUP.md** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook'–æ–≤
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ webhook –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

**–°–æ–¥–µ—Ä–∂–∏—Ç:**
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook'–æ–≤ –¥–ª—è amoCRM
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ webhook'–æ–≤
- ‚úÖ Troubleshooting

**–î–ª—è –∫–æ–≥–æ:** –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π, DevOps –∏–Ω–∂–µ–Ω–µ—Ä—ã

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### **1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π**
```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
make migrate

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
make migrate-create MESSAGE="Add new table"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
make migrate-status
```

### **2. –ó–∞–ø—É—Å–∫ API —Å–µ—Ä–≤–µ—Ä–∞**
```bash
# –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫
./scripts/start-api.sh

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
./scripts/start-api.sh logs

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
./scripts/start-api.sh status
```

### **3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook'–æ–≤**
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ amoCRM webhook
curl -X POST http://localhost:8000/api/webhooks/amocrm/setup

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ webhook
curl -X POST http://localhost:8000/api/webhooks/amocrm/test
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–∞—Ö:
- `.env` - –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- `.env.staging` - staging –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- `.env.production` - production –æ–∫—Ä—É–∂–µ–Ω–∏–µ

### **–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**
```bash
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_URL=postgresql://asia:asia@db:5432/asia_crm_staging

# amoCRM
AMOCRM_CLIENT_ID=your_client_id
AMOCRM_CLIENT_SECRET=your_client_secret
AMOCRM_DOMAIN=your_domain.amocrm.ru

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
SECRET_KEY=your_secret_key
JWT_SECRET=your_jwt_secret
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π**
```bash
# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
make migrate-create MESSAGE="Test migration"

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
make migrate

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
make migrate-status
```

### **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API**
```bash
# Health check
curl http://localhost:8000/health

# API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
open http://localhost:8000/docs

# –¢–µ—Å—Ç endpoints
curl http://localhost:8000/api/leads/
```

### **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ webhook'–æ–≤**
```bash
# –¢–µ—Å—Ç amoCRM webhook
curl -X POST http://localhost:8000/api/webhooks/amocrm/test \
  -H "Content-Type: application/json" \
  -d '{"test": "data"}'
```

## üö® Troubleshooting

### **–ü—Ä–æ–±–ª–µ–º—ã —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ë–î
docker-compose exec db pg_isready -U asia

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose logs backend

# –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
make migrate-down
```

### **–ü—Ä–æ–±–ª–µ–º—ã —Å API**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker-compose restart backend

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
docker-compose exec backend env
```

### **–ü—Ä–æ–±–ª–µ–º—ã —Å webhook'–∞–º–∏**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ webhook'–æ–≤
docker-compose logs backend | grep webhook

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ amoCRM
curl http://localhost:8000/api/auth/amo/status
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **–õ–æ–≥–∏**
```bash
# –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose logs -f

# –¢–æ–ª—å–∫–æ backend
docker-compose logs -f backend

# –§–∏–ª—å—Ç—Ä –ø–æ –º–∏–≥—Ä–∞—Ü–∏—è–º
docker-compose logs backend | grep -i migration
```

### **–°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤**
```bash
# Health check
curl http://localhost:8000/health

# –°—Ç–∞—Ç—É—Å –ë–î
docker-compose exec db pg_isready -U asia

# –°—Ç–∞—Ç—É—Å Redis
docker-compose exec redis redis-cli ping
```

## üîó –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [CI/CD –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](../cicd/README.md) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](../ARCHITECTURE.md) - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](../SECURITY.md) - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](../quickstart/README.md) - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–∞—Ö
4. –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

---

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã APEX –∑–∞–≤–µ—Ä—à–µ–Ω–∞! üéâ**
